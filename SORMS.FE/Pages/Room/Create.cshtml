@{
    ViewData["Title"] = "Thêm phòng";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="container mt-4" style="max-width:720px;">
    <h3>Thêm phòng mới</h3>
    <form id="createForm" class="mt-3">
        <div class="mb-3">
            <label class="form-label">Tên phòng</label>
            <input id="name" class="form-control" required />
        </div>
        <div class="mb-3">
            <label class="form-label">Loại</label>
            <input id="type" class="form-control" />
        </div>
        <div class="mb-3">
            <label class="form-label">Giá (VNĐ)</label>
            <input id="price" type="number" class="form-control" min="0" />
        </div>
        <div class="mb-3">
            <label class="form-label">Trạng thái</label>
            <select id="isAvailable" class="form-select">
                <option value="true">Còn trống</option>
                <option value="false">Đã thuê</option>
            </select>
        </div>
        <button class="btn btn-success" type="submit">Tạo</button>
        <a href="/Room/Index" class="btn btn-secondary ms-2">Hủy</a>
    </form>
</div>

@section Scripts {
    <script>
        document.getElementById('createForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const token = localStorage.getItem("token");
            const payload = {
                name: document.getElementById('name').value.trim(),
                type: document.getElementById('type').value.trim(),
                price: document.getElementById('price').value ? Number(document.getElementById('price').value) : null,
                isAvailable: document.getElementById('isAvailable').value === 'true'
            };
            const res = await fetch('/api/Room', {
                method: 'POST',
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": "Bearer " + token
                },
                body: JSON.stringify(payload)
            });
            if (res.ok) {
                alert('Tạo phòng thành công.');
                window.location.href = '/Room/Index';
            } else {
                const t = await res.text();
                alert('Lỗi: ' + (t || res.statusText));
            }
        });
    </script>
}
